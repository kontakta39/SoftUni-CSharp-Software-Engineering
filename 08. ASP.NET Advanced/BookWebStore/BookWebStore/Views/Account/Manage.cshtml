@using Microsoft.AspNetCore.Identity
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager

@{
    ViewData["Title"] = "Manage Account";
    string? email = ViewData["UserEmail"]?.ToString();
    string? username = ViewData["Username"]?.ToString();
    string? activePage = ViewData["ActivePage"]?.ToString();
}

@if (SignInManager.IsSignedIn(User))
{
    <h1>Manage your account</h1>

    <div class="row">
        <div class="col-md-3">
            <!-- Sidebar -->
            <ul class="nav nav-pills flex-column">
                @if (User.IsInRole("Administrator") && email == "kontakta39@mail.bg" && username == "kontakta39")
                {
                    <li class="nav-item">
                        <a class="nav-link @(activePage == "ManageUsers" ? "active" : "")"
                           href="@Url.Action("Manage", "Account", new { page = "ManageUsers" })">Manage Users</a>
                    </li>
                }
                <li class="nav-item">
                    <a class="nav-link @(activePage == "Profile" ? "active" : "")"
                       href="@Url.Action("Manage", "Account", new { page = "Profile" })">Profile</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link @(activePage == "Email" ? "active" : "")"
                       href="@Url.Action("Manage", "Account", new { page = "Email" })">Email</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link @(activePage == "ChangePassword" ? "active" : "")"
                       href="@Url.Action("Manage", "Account", new { page = "ChangePassword" })">Change password</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link @(activePage == "DeleteAccount" ? "active" : "")"
                       href="@Url.Action("Manage", "Account", new { page = "DeleteAccount" })">Delete account</a>
                </li>
            </ul>
        </div>

        <div class="col-md-9">
            <!-- Depending on the value of ActivePage, the corresponding partial view is displayed. -->
            @if (activePage == "ManageUsers" && User.IsInRole("Administrator") && email == "kontakta39@mail.bg" && username == "kontakta39")
            {
                @Html.Partial("_ManageUsersPartial")
            }
            else if (activePage == "Profile")
            {
                @Html.Partial("_ProfilePartial")
            }
            else if (activePage == "Email")
            {
                @Html.Partial("_EmailPartial")
            }
            else if (activePage == "ChangePassword")
            {
                @Html.Partial("_ChangePasswordPartial")
            }
            else if (activePage == "DeleteAccount")
            {
                @Html.Partial("_DeleteAccountPartial")
            }
        </div>
    </div>
}